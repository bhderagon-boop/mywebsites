<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>پنل مدیریت بازی‌ها</title>
  <style>
    body { font-family: Tahoma; direction: rtl; margin: 20px; }
    input, button { margin: 5px; padding: 5px; }
    #games-list { margin-top: 20px; }
  </style>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>پنل مدیریت بازی‌ها</h2>

  <label>نام بازی: <input type="text" id="gameName"></label><br>
  <label>امتیاز: <input type="number" id="gameScore"></label><br>
  <button onclick="saveGame()">ذخیره بازی</button>

  <h3>لیست بازی‌ها</h3>
  <ul id="games-list"></ul>

  <script>
    let db;
    let request = indexedDB.open("GamesDB", 1);

    request.onupgradeneeded = function(e) {
      db = e.target.result;
      if (!db.objectStoreNames.contains("games")) {
        db.createObjectStore("games", { keyPath: "id", autoIncrement: true });
      }
    };

    request.onsuccess = function(e) {
      db = e.target.result;
      loadGames();
    };

    request.onerror = function(e) {
      console.error("خطا در باز کردن دیتابیس:", e.target.error);
    };

    function saveGame() {
      let name = document.getElementById("gameName").value;
      let score = parseInt(document.getElementById("gameScore").value);

      if (!name || isNaN(score)) {
        alert("لطفاً نام و امتیاز بازی را وارد کنید");
        return;
      }

      let transaction = db.transaction(["games"], "readwrite");
      let store = transaction.objectStore("games");
      store.add({ name: name, score: score });

      transaction.oncomplete = function() {
        alert("✅ بازی ذخیره شد");
        loadGames();
      };

      transaction.onerror = function(e) {
        console.error("خطا در ذخیره:", e.target.error);
      };
    }

    function loadGames() {
      let list = document.getElementById("games-list");
      list.innerHTML = "";

      let transaction = db.transaction(["games"], "readonly");
      let store = transaction.objectStore("games");
      let request = store.openCursor();

      request.onsuccess = function(e) {
        let cursor = e.target.result;
        if (cursor) {
          let li = document.createElement("li");
          li.textContent = cursor.value.name + " - امتیاز: " + cursor.value.score;
          list.appendChild(li);
          cursor.continue();
        }
      };
    }
  </script>
</body>

</html>
