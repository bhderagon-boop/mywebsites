<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>بازی‌ها</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>لیست بازی‌ها</h2>
  <ul id="games-list"></ul>

  <script>
    let db;
    let request = indexedDB.open("GamesDB", 1);

    request.onsuccess = function(e){
      db = e.target.result;
      showGames();
    };

    function showGames(){
      let transaction = db.transaction(["games"], "readonly");
      let store = transaction.objectStore("games");
      let req = store.getAll();

      req.onsuccess = function(){
        let games = req.result;
        let list = document.getElementById("games-list");

        games.forEach(g => {
          let li = document.createElement("li");
          let btn = document.createElement("button");
          btn.textContent = `دانلود: ${g.name}`;
          btn.onclick = () => {
            let blob = new Blob([g.data]);
            let url = URL.createObjectURL(blob);
            let a = document.createElement("a");
            a.href = url;
            a.download = g.filename;
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
          };
          li.appendChild(btn);
          list.appendChild(li);
        });
      };
    }
  </script>
</body>
</html>